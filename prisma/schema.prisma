// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "/app/generated/prisma-client"
}

datasource db {
  provider = "postgresql"
}

model PoFile {
  id         String    @id @default(cuid())
  filename   String
  filesize   Int
  uploadedAt DateTime  @default(now())
  language   String?
  metadata   PoFileMetadata[]
  entries    PoEntry[]
}

model PoEntry {
  id        Int      @id @default(autoincrement())
  msgid     String
  msgstr    String
  description String?
  references  String?
  fileId    String
  file      PoFile   @relation(fields: [fileId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  @@index([fileId])
}

model PoFileMetadata {
  id      Int     @id @default(autoincrement())
  key     String
  value   String
  fileId  String
  file    PoFile  @relation(fields: [fileId], references: [id], onDelete: Cascade)

  @@unique([fileId, key])
}

model TranslationTable {
  id          String              @id @default(cuid())
  name        String
  language    String
  description String?
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
  entries     TranslationEntry[]
}

model TranslationEntry {
  id          Int                @id @default(autoincrement())
  sourceText  String
  translatedText String
  description String?
  references  String?
  tableId     String
  table       TranslationTable   @relation(fields: [tableId], references: [id], onDelete: Cascade)
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  @@index([tableId])
}